# ===============================
# 基于 Prompt 提示工程的行人重识别
# Pipeline 配置文件
# ===============================

# -------- 基础路径 --------
project_root: .
data_root: ./data
dataset: market1501
outputs_root: ./outputs

# -------- 实验控制 --------
experiment:
  name: "full_v0"          # 当前实验名，运行时建议自动生成时间戳子目录
  seed: 42                 # 随机种子，保证可复现
  log_dir: ./outputs/logs  # 日志输出目录
  save_interval: 100       # 每多少 step 保存一次（若后续涉及训练/微调）

# -------- LLM 配置 --------
llm:
  provider: "openai_compatible"  # 也可以是 "ollama" / "openai"
  api_base_env: "LLM_API_BASE"   # export LLM_API_BASE=...
  api_key_env:  "LLM_API_KEY"    # export LLM_API_KEY=...
  model: "gpt-4o-mini"           # 默认模型，可切换
  max_tokens: 512
  temperature: 0.2               # 输出稳定性（越低越确定）

# -------- Prompt 文件路径 --------
prompt:
  base: ./prompts/base.txt
  salient: ./prompts/salient.txt
  json: ./prompts/json.txt
  base_plus_salient: ./prompts/base_plus_salient.txt

# -------- CLIP 模型配置 --------
clip:
  model: "ViT-B/32"   # 可选：ViT-B/16, RN50 等
  device: "cuda"      # "cuda" or "cpu"
  pretrained: true

# -------- Faiss 索引配置 --------
faiss:
  use_gpu: true
  nlist: 100          # 聚类中心数（IVF 索引用）
  nprobe: 10          # 查询时搜索的簇数量

# -------- 检索参数 --------
retrieval:
  mode: "fusion"      # 可选：text2image / image2text / fusion
  fusion_alpha: 0.7   # 图像/文本特征融合权重
  topk: 100           # 返回前 K 个候选

# -------- 评测配置 --------
evaluation:
  metrics: ["rank1", "mAP", "CMC"]  # 默认计算的指标
  cmc_ranks: [1, 5, 10]             # CMC 曲线统计点
  save_cases: 20                    # 保存多少可视化案例
  case_output_dir: ./outputs/cases

# -------- 日志与监控 --------
logging:
  level: "INFO"       # DEBUG / INFO / WARNING / ERROR
  log_file: ./outputs/logs/pipeline.log
  enable_wandb: false # 是否启用 Weights & Biases
  wandb_project: "reid-prompt"

